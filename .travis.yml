language: cpp 

cache:
  apt: true

matrix: 
   include: 
     - os: linux
       compiler: gcc
     - os: osx
       compiler: clang++

addons: 
   apt: 
    sources: 
      - kalakris-cmake 
      - boost-latest 
      - kubuntu-backports 
    packages: 
      - cmake 
      - libgtest-dev 
      - doxygen-latex 
      - libusb-1.0-0-dev 

cache: 
  directories: 
  - $HOME/flann 
  - $HOME/vtk 
  - $HOME/qhull 
  - $HOME/doxygen 

# http://dl.google.com/android/repository/android-ndk-r11c-windows-x86.zip
# http://dl.google.com/android/repository/android-ndk-r11c-windows-x86_64.zip
# wget http://dl.google.com/android/ndk/android-ndk-r8c-darwin-x86.tar.bz2
# tar -jxvf android-ndk-r8c-darwin-x86.tar.bz2
# cd android-ndk-r8c
# CMake Update(NG)
# sudo apt-get install software-properties-common;
# sudo add-apt-repository ppa:george-edison55/cmake-3.x;
# sudo apt-get update;
# travis_wait 45 sudo apt-get install cmake;
# cmake --version;
before_install:
  - if [[ $TRAVIS_OS_NAME = "osx" ]]; then
      brew update >/dev/null;

      wget http://dl.google.com/android/repository/android-ndk-r11c-darwin-x86_64.zip;
      unzip -q android-ndk-r11c-darwin-x86_64.zip;
      cd android-ndk-r11c;
      export ANDROID_NDK=$PWD;

      cd ..;
      mkdir build;
      cd build;
      cmake -DBUILD_IOS_DEVICE:BOOL=ON -DBUILD_IOS_DEVICE:BOOL=ON -BUILD_IOS_SIMULATOR:BOOL=ON ../;
    fi

  - if [[ $TRAVIS_OS_NAME = "linux" ]]; then
      sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test;
      sudo apt-get -qq update;
      sudo apt-get -qq install g++-4.9 -y;
      wget --no-check-certificate -qO- http://www.cmake.org/files/v3.4/cmake-3.4.1-Linux-x86_64.tar.gz -O /tmp/cmake-3.4.1-Linux-x86_64.tar.gz;
      tar -xvf /tmp/cmake-3.4.1-Linux-x86_64.tar.gz;
      export PATH=$PWD/cmake-3.4.1-Linux-x86_64/bin/:$PATH;

      wget http://dl.google.com/android/repository/android-ndk-r11c-linux-x86_64.zip;
      unzip -q android-ndk-r11c-linux-x86_64.zip;
      cd android-ndk-r11c;
      export ANDROID_NDK=$PWD;

      cd ..;
      mkdir build;
      cd build;
      cmake -DIOS_PLATFORM_LOCATION="OS" ../;
    fi


install:
    - travis_wait 45 make -j4

